---
title: "[BOJ 10327] 피보나치 문제 해결 전략"
date: 2020-12-04 11:33:00 +0800
categories: [Algorithm]
tags: [BOJ]
use_math: true
---



 확장된 유클리드 알고리즘을 사용하는 문제이다. 처음 배워 보는 알고리즘으로 풀어보는 거라 신박했다.

## 1. 초항 구하기

  먼저 $a, b$가 자연수라는 조건을 무시하고 진행해보자. 알아낼 수 있는 사실로는 아래의 식을 구해볼 수 있다.
$$
F_{k} = ax+by
$$
 왜냐하면 피보나치수열의 초항이 더해지는 형태이기 때문에 이런식이 나올 수 있다. 또한 여기서 x, y가 무엇인지도 알 수 있다.
$$
F_{k} = F_{k-2}a+F_{k-1}b
$$
이 식이 나오는 이유는 직접구해보면 알 수 있을 것이다. 이런 형태면 확장 유클리드 호제법을 사용할 수 있는 형태가 된다. k는 범위가 작으니 모두 해봐도 된다.

 가능한 $a, b$ 중 제일 작고 자연수인 것이 초항이 될 것이다. 하지만 확장 유클리드 호제법은 정수인 $a, b$를 구하기 때문에 자연수 $a, b$를 구하기 위해서는 다른 방법이 필요하다.



 ## 2. 자연수인 초항 구하기

 위의 식의 선형 디오판토스 방정식 꼴을 가지며 $a, b$가 유일한 해가 아니다. 그러므로 다른 해를 구할 수 있다면 그 해 중 자연수 $a, b$만 고르면 되지 않을까? 라는 생각을 할 수 있다.

 선형 디오판토스 방정식의 다른 해는 아래의 공식을 대입해서 구할 수 있다.
$$
a_2 = a_1 + k\frac{y}{gcd(x, y)}
$$

$$
b_2 = b_1 - k\frac{x}{gcd(x,y)}
$$

 여기서 알 수 있는 사실은 $x = F_{k-2}, y = F_{k-1}$ 이고, $gcd(F_{k-2}, F_{k-1}) = 1$ 이라는 사실을 알 수 있다. 그리고 자연수일 조건 부등식을 적용하면 k값을 손 쉽게 알아낼 수 있다.
$$
0 < a_1 + ky, \frac{-a_1}{y} < k
$$

$$
0 < b_1 - kx, \frac{b_1}{x} > k 
$$

$$
k= min([\frac{-a_1}{y}], [\frac{b_1}{x}])
$$

 우리는 $a, b$가 자연수가 되는 $k$를 찾았으므로 대입해주기만 하면 바로 자연수인 초항을 바로 구할 수 있다.



## 3.소스 코드

<div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div><div style="line-height:130%">51</div><div style="line-height:130%">52</div><div style="line-height:130%">53</div><div style="line-height:130%">54</div><div style="line-height:130%">55</div><div style="line-height:130%">56</div><div style="line-height:130%">57</div><div style="line-height:130%">58</div><div style="line-height:130%">59</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;&lt;bits/stdc++.h&gt;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">using&nbsp;namespace&nbsp;std;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">typedef&nbsp;long&nbsp;long&nbsp;ll;</div><div style="padding:0 6px; white-space:pre; line-height:130%">typedef&nbsp;pair&lt;ll,&nbsp;ll&gt;&nbsp;pll;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">pll&nbsp;exeuc(ll&nbsp;a,&nbsp;ll&nbsp;b,&nbsp;ll&nbsp;w)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(b&nbsp;==&nbsp;0)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&nbsp;1,&nbsp;0&nbsp;};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pll&nbsp;p&nbsp;=&nbsp;exeuc(b,&nbsp;a&nbsp;%&nbsp;b,&nbsp;w);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&nbsp;p.second,&nbsp;p.first&nbsp;-&nbsp;(a&nbsp;/&nbsp;b)&nbsp;*&nbsp;p.second&nbsp;};</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;main()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;ios::sync_with_stdio(0);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;cin.tie(0),&nbsp;cout.tie(0);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;ll&gt;&nbsp;pibo;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pibo.push_back(1);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pibo.push_back(1);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(true)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;sz&nbsp;=&nbsp;pibo.size();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(pibo[sz&nbsp;-&nbsp;1]&nbsp;+&nbsp;pibo[sz&nbsp;-&nbsp;2]&nbsp;&gt;&nbsp;1e9)&nbsp;break;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pibo.push_back(pibo[sz&nbsp;-&nbsp;1]&nbsp;+&nbsp;pibo[sz&nbsp;-&nbsp;2]);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;tc;&nbsp;cin&nbsp;&gt;&gt;&nbsp;tc;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(tc--)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ll&nbsp;n;&nbsp;cin&nbsp;&gt;&gt;&nbsp;n;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pll&nbsp;ans&nbsp;=&nbsp;{&nbsp;1e9,&nbsp;1e9&nbsp;};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;pibo.size()&nbsp;-&nbsp;2;&nbsp;i++)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ll&nbsp;a&nbsp;=&nbsp;pibo[i],&nbsp;b&nbsp;=&nbsp;pibo[i+1];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pll&nbsp;p&nbsp;=&nbsp;exeuc(a,&nbsp;b,&nbsp;n);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.first*=n,&nbsp;p.second*=n;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ll&nbsp;x&nbsp;=&nbsp;p.first,&nbsp;y&nbsp;=&nbsp;p.second;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ll&nbsp;k&nbsp;=&nbsp;min(ceil((double)y&nbsp;/&nbsp;a),&nbsp;ceil((double)-x&nbsp;/&nbsp;b));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;x&nbsp;+&nbsp;b&nbsp;*&nbsp;k;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;y&nbsp;-&nbsp;a&nbsp;*&nbsp;k;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(x&nbsp;&lt;&nbsp;0&nbsp;||&nbsp;y&nbsp;&lt;&nbsp;0)&nbsp;continue;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(x&nbsp;+&nbsp;y&nbsp;&lt;&nbsp;ans.first&nbsp;+&nbsp;ans.second)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;=&nbsp;{&nbsp;x,&nbsp;y&nbsp;};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ans.first&nbsp;&gt;&nbsp;ans.second&nbsp;||&nbsp;ans.first&nbsp;==&nbsp;0)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;ans.second&nbsp;&lt;&lt;&nbsp;"&nbsp;"&nbsp;&lt;&lt;&nbsp;ans.first&nbsp;+&nbsp;ans.second&nbsp;&lt;&lt;&nbsp;"\n";</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;&lt;&lt;&nbsp;ans.first&nbsp;&lt;&lt;&nbsp;"&nbsp;"&nbsp;&lt;&lt;&nbsp;ans.second&nbsp;&lt;&lt;&nbsp;"\n";</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>







